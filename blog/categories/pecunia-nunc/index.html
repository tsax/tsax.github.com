
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Category: Pecunia-nunc - Tushar's Blog</title>
  <meta name="author" content="Tushar Saxena">

  
  <meta name="description" content="Category: pecunia-nunc">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.tusharsaxena.comblog/categories/pecunia-nunc">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Tushar's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  

</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <div class="all-posts">
  <div class="container">
    <div class="row">
      <div class="list-title col-md-offset-3 col-md-6">
        <h4>Posts in pecunia-nunc</h4>
      </div>
    </div>
  </div>

  <div class="article-list">
    <div class="container">
      
        
        <div class="row">
          <div class="col-md-offset-3 col-md-6">
            <article>
  <h2><a href="/blog/2013/07/01/pecunia-nunc-is-live/">Pecunia Nunc Is Live!</a></h2>
  
  <p>
    <p>A few months ago, I came across this:
<div class='embed tweet'><blockquote class="twitter-tweet"><p>Anyone interested in working <a href="https://twitter.com/kickstarter">@kickstarter</a> I bet if you implemented <a href="https://twitter.com/peterc">@peterc</a> great idea that&#39;d be a leg up :-) <a href="https://t.co/bdqc9Ep7">https://t.co/bdqc9Ep7</a></p>&mdash; Avi Flombaum (@aviflombaum) <a href="https://twitter.com/aviflombaum/statuses/280470459059933186">December 17, 2012</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>
The link in the above tweet was to this:
<div class='embed tweet'><blockquote class="twitter-tweet"><p>I&#39;d subscribe to a daily newsletter that alerted me to interesting Kickstarters ending today &amp; are funded (or close to it). Do it, KS! :)</p>&mdash; Peter Cooper (@peterc) <a href="https://twitter.com/peterc/statuses/280470229094637568">December 17, 2012</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div></p>

<p>As I was and am interested in working for Kickstarter, and was looking to shore up my portfolio, particularly with Ruby projects, I decided to take on the project.</p>

<p>After many false starts, I present to you...<em>drum roll please</em>...</p>

<p><a href="http://pecunia-nunc.herokuapp.com"><strong>Pecunia Nunc</strong></a></p>

<p>The idea is to send a daily digest of Kickstarter projects that fit a certain criteria to subscribers, such as
- The projects are close to the finish line (>80% of goal funded)
- The projects are ending soon (within 48 hours)</p>

<p>I believe this will enable Kickstarter enthusiasts who don't have time to browse the many interesting, worthy projects regularly to fund them when they most need help. Scanning the email in the morning takes 10-15 seconds, or more if you happen to find a project to like.</p>

<p>I hope I've fulfiled a need.
If not, there's always next time.</p>

<p>Enjoy!</p>

  </p>
  <span class="meta">
    written 








  



<time datetime="2013-07-01T22:02:00-04:00" pubdate data-updated="true">Jul 1<span>st</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/pecunia-nunc/'>pecunia-nunc</a>, <a class='category' href='/blog/categories/side-projects/'>side-projects</a>
  
</span>


  </span>

  
</article>

          </div>
        </div>
      
        
        <div class="row">
          <div class="col-md-offset-3 col-md-6">
            <article>
  <h2><a href="/blog/2013/04/09/im-not-a-spammer/">I'm Not a Spammer</a></h2>
  
  <p>
    <p>For my current side-project, I need to send emails to a list of people whose email addresses are stored in the database. My concern, as you can imagine, is to prevent spamming my users in instances of error or otherwise. There's several ways to do this. As usual, it comes down to a choice - a judgement call from among the many choices.</p>

<ol>
<li>Creating an emails model to keep track of when an email was sent and to whom.</li>
<li>Storing the last time a user received an email in the user model.</li>
</ol>


<p>You can think of many others ways to do this of course.
I decided to go with the second option as it required minimal effort and has so far turned out
very well. This was accomplished with a single <code>rails generate migration AddLastEmailToSubscribers last_email:datetime</code>.</p>

<p>This will create the following migration
``` ruby AddLastEmailToSubscribers
class AddLastEmailToSubscribers &lt; ActiveRecord::Migration
  def change</p>

<pre><code>add_column :subscribers, :last_email, :datetime
</code></pre>

<p>  end
end</p>

<p><code>
From here, I can simply check if the :last_email is nil or a day before today's,
and if so, then send the day's email, and then update the last_email to</code>Time.now```</p>

<p>Simple.</p>

  </p>
  <span class="meta">
    written 








  



<time datetime="2013-04-09T02:05:00-04:00" pubdate data-updated="true">Apr 9<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/learning/'>learning</a>, <a class='category' href='/blog/categories/pecunia-nunc/'>pecunia-nunc</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>, <a class='category' href='/blog/categories/side-projects/'>side-projects</a>
  
</span>


  </span>

  
</article>

          </div>
        </div>
      
        
        <div class="row">
          <div class="col-md-offset-3 col-md-6">
            <article>
  <h2><a href="/blog/2013/03/25/redirect-to-and-preservation-of-errors/">Redirect_to and Preservation of Errors</a></h2>
  
  <p>
    <p>Working on my side project, <a href="https://github.com/tsax/pecunia-nunc/">Pecunia-Nunc</a>, I was baffled when the errors on the object creation form would not display upon submission. The controller looked like this</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">SubscribersController</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="no">ApplicationController</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;def new&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="nb">require</span> <span class="s1">&#39;digest&#39;</span>
</span><span class='line'><span class="vi">@subscriber</span> <span class="o">=</span> <span class="no">Subscriber</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:subscriber</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="vi">@subscriber</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="ss">Digest</span><span class="p">:</span><span class="ss">:SHA1</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(</span><span class="o">[</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="nb">rand</span><span class="o">].</span><span class="n">join</span><span class="p">)</span>
</span><span class='line'><span class="k">if</span> <span class="vi">@subscriber</span><span class="o">.</span><span class="n">save</span>
</span><span class='line'>    <span class="n">flash</span><span class="o">[</span><span class="ss">:notice</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Thanks for signing-up. Please confirm your email address through the email that&#39;ll be in your inbox shortly!&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">redirect_to</span> <span class="n">home_path</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>    <span class="n">flash</span><span class="o">[</span><span class="ss">:notice</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;There were errors! Please resubmit after making corrections.&quot;</span>
</span><span class='line'>    <span class="n">redirect_to</span> <span class="n">home_path</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="k">end</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>The view :
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">%</span> <span class="k">if</span> <span class="vi">@subscriber</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">any?</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;div id=&quot;error_explanation&quot;&gt;</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&quot;alert alert-error&quot;&amp;gt;</span>
</span><span class='line'><span class="sr">  The form contains &amp;lt;%= pluralize(@subscriber.errors.count, &quot;error&quot;) %&amp;gt;.</span>
</span><span class='line'><span class="sr">&amp;lt;/</span><span class="n">div</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">ul</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">%</span> <span class="vi">@subscriber</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">full_messages</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">msg</span><span class="o">|</span> <span class="sx">%&amp;gt;</span>
</span><span class='line'><span class="sx">  &amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">li</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">*</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">%=</span> <span class="n">msg</span> <span class="sx">%&amp;gt;&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">/</span><span class="n">li</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">%</span> <span class="k">end</span> <span class="sx">%&amp;gt;</span>
</span><span class='line'><span class="sx">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">/</span><span class="n">ul</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'><span class="sr">&amp;lt;% end %&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>As you can tell, the problem was not in the view at all, but in this line <code>redirect_to home_path</code>. Redirection clears the object.errors field, and therefore nothing was being displayed. I stupidly spent a lot of time fiddling with the view, instead of inspecting the controller action. Replacing the problematic line with <code>render 'new'</code> ('new' is the action/view that renders the form) solved the problem by preserving the .errors object.</p>

  </p>
  <span class="meta">
    written 








  



<time datetime="2013-03-25T00:38:00-04:00" pubdate data-updated="true">Mar 25<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/debugging/'>debugging</a>, <a class='category' href='/blog/categories/pecunia-nunc/'>pecunia-nunc</a>, <a class='category' href='/blog/categories/side-projects/'>side-projects</a>
  
</span>


  </span>

  
</article>

          </div>
        </div>
      
    </div>
  </div>
</div>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/tushar_saxena"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    

    
    <a href="https://github.com/tsax"><img src="/images/glyphicons_social_21_github.png"/></a>
    

    

    
  </div>
</div>

<div class="pull-right">
  <h4>Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>


    </div>
  </div>
</footer>

  </body>
</html>
